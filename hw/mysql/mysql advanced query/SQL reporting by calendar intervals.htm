<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#" lang="en-US"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SQL reporting by calendar intervals</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="http://www.plumislandmedia.net/xmlrpc.php">
<!--[if IE]><script src="http://www.plumislandmedia.net/wp-content/themes/arcade-basic/library/js/html5.js"></script><![endif]-->

<!-- This site is optimized with the Yoast WordPress SEO plugin v1.7.1 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="How to use MySQL to aggregate time series data by calendar intervals, like day, week, month, and quarter">
<link rel="canonical" href="http://www.plumislandmedia.net/mysql/sql-reporting-time-intervals/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL reporting by calendar intervals">
<meta property="og:description" content="How to use MySQL to aggregate time series data by calendar intervals, like day, week, month, and quarter">
<meta property="og:url" content="http://www.plumislandmedia.net/mysql/sql-reporting-time-intervals/">
<meta property="og:site_name" content="Plum Island Media">
<meta property="article:section" content="MySQL">
<meta property="article:section" content="Reference">
<meta property="article:section" content="SQL Time Processing">
<meta property="article:published_time" content="2014-01-30T12:50:27+00:00">
<meta property="article:modified_time" content="2014-11-05T12:22:02+00:00">
<meta property="og:updated_time" content="2014-11-05T12:22:02+00:00">
<meta property="fb:admins" content="100003751994587">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="How to use MySQL to aggregate time series data by calendar intervals, like day, week, month, and quarter">
<meta name="twitter:title" content="SQL reporting by calendar intervals">
<meta name="twitter:site" content="@RevOllieJones">
<meta name="twitter:domain" content="Plum Island Media">
<meta name="twitter:creator" content="@RevOllieJones">
<!-- / Yoast WordPress SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="Plum Island Media » Feed" href="http://www.plumislandmedia.net/feed/">
<link rel="alternate" type="application/rss+xml" title="Plum Island Media » Comments Feed" href="http://www.plumislandmedia.net/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Plum Island Media » SQL Reporting by time intervals Comments Feed" href="http://www.plumislandmedia.net/mysql/sql-reporting-time-intervals/feed/">
<link rel="stylesheet" id="theme_stylesheet-group-css" href="SQL%20reporting%20by%20calendar%20intervals_files/minify-b1-theme_stylesheet-1a9b54791c3e984506bdb4d151197947.css" type="text/css" media="all">
<link rel="stylesheet" id="google_fonts-css" href="SQL%20reporting%20by%20calendar%20intervals_files/css.css" type="text/css" media="all">
<script src="SQL%20reporting%20by%20calendar%20intervals_files/ca-pub-6636501829887153.js" type="text/javascript" async=""></script><script src="SQL%20reporting%20by%20calendar%20intervals_files/analytics.js" async=""></script><script type="text/javascript" src="SQL%20reporting%20by%20calendar%20intervals_files/jquery.js"></script>
<script type="text/javascript" src="SQL%20reporting%20by%20calendar%20intervals_files/minify-b1-wp-markdown-prettify-eae7faa40e2bcab98189a044933e44.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.plumislandmedia.net/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.plumislandmedia.net/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="http://www.plumislandmedia.net/?p=197">

<!-- BEGIN GADWP v4.3.6 Universal Tracking - https://deconf.com/google-analytics-dashboard-wordpress/ -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37369414-1', 'auto');  ga('send', 'pageview');
</script>
<!-- END GADWP Universal Tracking -->

<style>
.container { max-width: 1170px; }
</style>
	<link href="SQL%20reporting%20by%20calendar%20intervals_files/shCore.css" type="text/css" rel="stylesheet"><link href="SQL%20reporting%20by%20calendar%20intervals_files/shThemeDefault.css" type="text/css" rel="stylesheet"><style type="text/css" id="syntaxhighlighteranchor"></style>
</head>
<body class="single single-post postid-197 single-format-standard no-fittext basic">

	<div id="page">

		<header id="header">
			<nav id="site-navigation" class="navbar navbar-inverse navbar-fixed-top black" role="navigation">
				<h3 class="sr-only">Main menu</h3>
				<a class="sr-only" href="#primary" title="Skip to content">Skip to content</a>

				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
				        <span class="icon-bar"></span>
				        <span class="icon-bar"></span>
				        <span class="icon-bar"></span>
				    </button>
				</div>

				<div class="collapse navbar-collapse">
					<ul id="menu-main" class="nav navbar-nav"><li id="menu-item-406" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-406"><a href="http://www.plumislandmedia.net/category/geography/">Geography</a></li>
<li id="menu-item-403" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent active menu-item-403"><a href="http://www.plumislandmedia.net/category/mysql/">MySQL</a></li>
<li id="menu-item-614" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-614"><a href="http://www.plumislandmedia.net/category/oracle/">Oracle</a></li>
<li id="menu-item-408" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-408"><a href="http://www.plumislandmedia.net/category/signs/">Digital Signs</a></li>
<li id="menu-item-404" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent active menu-item-404"><a href="http://www.plumislandmedia.net/category/reference/">Reference</a></li>
<li id="menu-item-405" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-405"><a href="http://www.plumislandmedia.net/category/wordpress/">WordPress</a></li>
<li id="menu-item-407" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-407"><a href="http://www.plumislandmedia.net/category/rhetoric/">Rhetoric</a></li>
<li id="menu-item-116" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-116"><a href="http://www.plumislandmedia.net/about/">About</a></li>
</ul>				</div>
			</nav><!-- #site-navigation -->

			 <div class="title-card-wrapper">
                <div style="height: 300px;" class="title-card">
    				<div id="site-meta">
    					<h1 id="site-title">
    						<a href="http://www.plumislandmedia.net/" title="Plum Island Media" rel="home"><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(0px) translateY(52px) rotate(-18deg);" class="char1">P</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(-1px) translateY(42px) rotate(-16deg);" class="char2">l</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(-2px) translateY(33px) rotate(-14deg);" class="char3">u</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(-2px) translateY(21px) rotate(-11deg);" class="char4">m</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(-2px) translateY(13px) rotate(-9deg);" class="char5 empty">&nbsp;</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(-2px) translateY(8px) rotate(-7deg);" class="char6">I</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(-1px) translateY(3px) rotate(-4deg);" class="char7">s</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(-1px) translateY(1px) rotate(-3deg);" class="char8">l</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(0px) translateY(0px) rotate(-1deg);" class="char9">a</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(0px) translateY(0px) rotate(1deg);" class="char10">n</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(1px) translateY(2px) rotate(3deg);" class="char11">d</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(1px) translateY(5px) rotate(5deg);" class="char12 empty">&nbsp;</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(2px) translateY(12px) rotate(8deg);" class="char13">M</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(2px) translateY(22px) rotate(12deg);" class="char14">e</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(2px) translateY(33px) rotate(14deg);" class="char15">d</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(1px) translateY(42px) rotate(16deg);" class="char16">i</span><span style="display: inline-block; transition: none 0s ease 0s ; transform: translateX(0px) translateY(52px) rotate(18deg);" class="char17">a</span></a>
    					</h1>

    					
    					<h2 id="site-description" class="margin-top">
    						Social Networks for the life of the world    					</h2>

    					<a data-scroll-to="300" href="#" id="more-site" class="btn btn-default btn-lg">See More</a>
    				</div>

    							<img style="position: absolute; left: 0px; top: -134px; right: auto; bottom: auto; height: auto; width: 100%;" class="header-img" src="SQL%20reporting%20by%20calendar%20intervals_files/ropes.jpg" alt="">
							</div>
			</div>

		</header>

		<main>
	<div class="container">
		<div class="row">
			<div id="primary" class="col-md-9 hfeed">
				
						<article id="post-197" class="post-197 post type-post status-publish format-standard hentry category-mysql category-reference category-sql-time-processing clearfix xfolkentry">
		
	<h1 class="entry-title taggedlink">
					SQL Reporting by time intervals			</h1>

		<div class="entry-meta">
		by <span class="vcard author"><span class="fn"><a href="http://www.plumislandmedia.net/author/admin/" title="Posts by Ollie" rel="author">Ollie</a></span></span>&nbsp;on&nbsp;<a href="http://www.plumislandmedia.net/mysql/sql-reporting-time-intervals/" class="time"><time class="date published updated" datetime="2014-01-30">January 30, 2014</time></a>&nbsp;in&nbsp;<a href="http://www.plumislandmedia.net/category/mysql/" rel="category tag">MySQL</a>, <a href="http://www.plumislandmedia.net/category/reference/" rel="category tag">Reference</a>, <a href="http://www.plumislandmedia.net/category/sql-time-processing/" rel="category tag">SQL Time Processing</a>&nbsp;•&nbsp;<a href="http://www.plumislandmedia.net/mysql/sql-reporting-time-intervals/#comments" title="Comment on SQL Reporting by time intervals">6 Comments</a>	</div>
	
	    <div class="entry-content description clearfix">
		    <p><em>A version of this article <a title="Using SQL to report by time intervals in Oracle" href="http://www.plumislandmedia.net/sql-time-processing/using-sql-report-time-intervals-oracle/">specific to the Oracle DBMS is here</a>.</em></p>
<p>It’s often helpful to use SQL to group information by periods of 
time. For example, we might like to examine sales data. For example, we 
might have a table of individual sales transactions like so.</p>
<p><code> Sales:<br>
sales_id int<br>
sales_time datetime<br>
net decimal(7,2)<br>
tax decimal(7,2)<br>
gross decimal(7,2)<br>
</code></p>
<p>Each time we make a sale, a new row is inserted into this table. This
 kind of information is called a time series: each row data has its own 
DATETIME time stamp. &nbsp;Notice that we could, in MySQL, give each row
 a TIMESTAMP value instead. TIMESTAMPs are limited in range, however. 
They don’t work for dates before January 1, 1970. So, for many 
applications DATETIME values are preferable.</p>
<p>What can we do to report on this table? Here are several choices.</p>
<h2>Generate a detail report</h2>
<p>A detail report typically shows one row for each item in the raw data table. Here’s a query to do that.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">SELECT sales_time</span><span class="pun">,</span><span class="pln">
       gross
  FROM sales
 ORDER BY sales_time</span></pre>
<p>This is trivial, but it illustrates an important concept: it’s 
possible to order by DATETIME values. You may notice that every query in
 this article has an ORDER BY clause; that’s because SQL doesn’t have to
 present its results in any given order unless it has an ORDER BY 
clause.</p>
<p>We can also generate a detail report showing all yesterday’s sales, 
using this query. The trick here is a WHERE clause restricting the range
 of sales_time values.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">SELECT sales_time</span><span class="pun">,</span><span class="pln">
       gross
  FROM sales
 WHERE sales_time </span><span class="pun">&gt;=</span><span class="pln"> CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">1</span><span class="pln"> DAY
   AND sales_time </span><span class="pun">&lt;</span><span class="pln">  CURRENT_DATE</span><span class="pun">()</span><span class="pln">
 ORDER BY sales_time</span></pre>
<p>This query illustrates something important about using DATETIME 
ranges in WHERE clauses. When selecting a whole day’s worth of 
information, we want to include everything starting from midnight on the
 day in question (that is, “CURRENT_DATE() – INTERVAL 1 DAY” meaning 
yesterday). We want our range of dates to run up to but not including 
midnight on the day after the day in question. A common mistake is to 
use a WHERE / BETWEEN clause like this one.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln"> WHERE sales_time BETWEEN CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">1</span><span class="pln"> DAY
                      AND CURRENT_DATE</span><span class="pun">()</span><span class="pln">  </span><span class="com">/*wrong!*/</span></pre>
<p>This clause includes sales_time values equal to midnight on the current day, which is not desired.</p>
<p>Another common mistake is to write the WHERE clause using a DATE function like this.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln"> WHERE DATE</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln">
              CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">1</span><span class="pln"> DAY  </span><span class="com">/* inefficient!*/</span></pre>
<p>This yields correct results, but is inefficient.</p>
<h2>Summarize by day</h2>
<p>Now that we understand our basic detail data, we can generate all sorts of useful summary (or <em>aggregate</em>)
 reports. First, we can report gross daily sales. To do this, we need to
 be able to summarize our sales table by date. Here’s the SQL query to 
do that:</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">SELECT DATE</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> AS sales_date</span><span class="pun">,</span><span class="pln">
       SUM</span><span class="pun">(</span><span class="pln">gross</span><span class="pun">)</span><span class="pln"> AS total</span><span class="pun">,</span><span class="pln">
       COUNT</span><span class="pun">(*)</span><span class="pln"> AS transactions
  FROM sales
 GROUP BY DATE</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln">
 ORDER BY DATE</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span></pre>
<p>This uses the little formula DATE(sales_time) to convert a DATETIME 
timestamp into a pure date. It then groups by those pure dates sums up 
the gross sales and counts the transactions. The result set will contain
 a row for every date on which there were any sales.</p>
<h2>Summarize by month</h2>
<p>Second, we can report gross monthly sales with a similar query. To do
 this we need a formula to convert any DATETIME expression to the date 
of the first day of the month. This formula is a little trickier than 
DATE(sales_time), but ultimately it works the same way. It converts the 
DATETIME expression to a string that shows “01” for the day of the 
month, then converts that back to a date. This is it:</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">DATE</span><span class="pun">(</span><span class="pln">DATE_FORMAT</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">,</span><span class="pln"> </span><span class="str">'%Y-%m-01'</span><span class="pun">))</span></pre>
<p>We can apply this to our query to get a summary of sales by month.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">SELECT DATE</span><span class="pun">(</span><span class="pln">DATE_FORMAT</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">,</span><span class="pln"> </span><span class="str">'%Y-%m-01'</span><span class="pun">))</span><span class="pln"> AS month_beginning</span><span class="pun">,</span><span class="pln">
       SUM</span><span class="pun">(</span><span class="pln">gross</span><span class="pun">)</span><span class="pln"> AS total</span><span class="pun">,</span><span class="pln">
       COUNT</span><span class="pun">(*)</span><span class="pln"> AS transactions
  FROM sales
 GROUP BY DATE</span><span class="pun">(</span><span class="pln">DATE_FORMAT</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">,</span><span class="pln"> </span><span class="str">'%Y-%m-01'</span><span class="pun">))</span><span class="pln">
 ORDER BY DATE</span><span class="pun">(</span><span class="pln">DATE_FORMAT</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">,</span><span class="pln"> </span><span class="str">'%Y-%m-01'</span><span class="pun">))</span></pre>
<h2>Summarize by calendar quarter</h2>
<p>Now let’s report quarterly sales. How do we convert a DATETIME value 
to a calendar quarter value? Fortunately, MySQL offers functions to 
extract the year and quarter from DATETIME expressions. Let’s blend 
those functions together to do this</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">DATE</span><span class="pun">(</span><span class="pln">CONCAT</span><span class="pun">(</span><span class="pln">YEAR</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">),</span><span class="str">'-'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">3</span><span class="pun">*(</span><span class="pln">QUARTER</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">),</span><span class="str">'-01'</span><span class="pun">))</span></pre>
<p>Applying this formula to our report, here’s what we get:</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">SELECT DATE</span><span class="pun">(</span><span class="pln">CONCAT</span><span class="pun">(</span><span class="pln">YEAR</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">),</span><span class="str">'-'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">3</span><span class="pun">*(</span><span class="pln">QUARTER</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">),</span><span class="str">'-01'</span><span class="pun">))</span><span class="pln"> AS quarter_beginning</span><span class="pun">,</span><span class="pln">
       SUM</span><span class="pun">(</span><span class="pln">gross</span><span class="pun">)</span><span class="pln"> AS total</span><span class="pun">,</span><span class="pln">
       COUNT</span><span class="pun">(*)</span><span class="pln"> AS transactions
  FROM sales
 GROUP BY DATE</span><span class="pun">(</span><span class="pln">CONCAT</span><span class="pun">(</span><span class="pln">YEAR</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">),</span><span class="str">'-'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">3</span><span class="pun">*(</span><span class="pln">QUARTER</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">),</span><span class="str">'-01'</span><span class="pun">))</span><span class="pln">
 ORDER BY DATE</span><span class="pun">(</span><span class="pln">CONCAT</span><span class="pun">(</span><span class="pln">YEAR</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">),</span><span class="str">'-'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">3</span><span class="pun">*(</span><span class="pln">QUARTER</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">),</span><span class="str">'-01'</span><span class="pun">))</span></pre>
<h2>Using valid DATE expressions</h2>
<p>Notice the discipline of always using valid dates for these reports. 
When we have valid dates, we gain all kinds of advantages in MySQL. For 
example, if we know the first day of a quarter, we can find out the last
 day with this expression.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">quarter_beginning </span><span class="pun">+</span><span class="pln"> INTERVAL </span><span class="lit">1</span><span class="pln"> QUARTER </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">1</span><span class="pln"> DAY</span></pre>
<p>For the quarterly reports we could have chosen something else. For 
example, instead of saying the quarter beginning on 2013-10-01, the 
first of October 2013, we could have generated the value CY2013Q4, 
meaning the fourth quarter of calendar year 2013. This expression would 
do that.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">CONCAT</span><span class="pun">(</span><span class="str">'CY'</span><span class="pun">,</span><span class="pln">YEAR</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">),</span><span class="str">'Q'</span><span class="pun">,</span><span class="pln">QUARTER</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">))</span></pre>
<p>But, expressions like “CY2013Q3″ and “CY2013Q4″ aren’t valid dates. 
Instead, they are text strings, so attempts to use them for date 
arithmetic will yield NULL values.</p>
<h2>Summarize by calendar week</h2>
<p>Summarizing time-series data by calendar week is useful, and it works
 very much like the other interval reports. To make this work, we need a
 formula that can yield the first day of the calendar week given any 
DATETIME value. If Sunday is the first day of the week, this is the 
formula to use.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span></pre>
<p>It retrieves the date of the preceding Sunday from any DATETIME 
value. This calendar-week expression works properly for all weeks, 
including the special case of weeks that span the end of calendar years.
 For example, for both Tuesday, December 31, 2013, and Thursday, January
 2, 2014, this expression returns Sunday, December 29, 2013.</p>
<p>In some jurisdictions, Monday is considered the first day of the week. This expression computes the preceding Monday’s date.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span></pre>
<p>You need to choose the appropriate expression for your country and 
your application’s customs about which day is the start of each week.</p>
<p>Here is the query to summarize sales by week (given a Sunday week start).</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">SELECT FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span><span class="pln"> AS week_beginning</span><span class="pun">,</span><span class="pln">
       SUM</span><span class="pun">(</span><span class="pln">gross</span><span class="pun">)</span><span class="pln"> AS total</span><span class="pun">,</span><span class="pln">
       COUNT</span><span class="pun">(*)</span><span class="pln"> AS transactions
  FROM sales
 GROUP BY FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span><span class="pln">
 ORDER BY FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span></pre>
<h2>Generate a summary of last week’s sales, day by day</h2>
<p>Now that we know how to handle days and weeks, we can generate a day-by-day summary of last week’s sales. Here’s how we do that.</p>
<p>First, we need an expression for the first day of last week. Here it is:</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">7</span><span class="pln"> DAY</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">
           MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">7</span><span class="pln"> DAY</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span></pre>
<p>Next, we need an expression for the first day of the present week. Here it is:</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">())</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">())</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span></pre>
<p>These two expressions need to be built into a WHERE clause, as follows.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln"> WHERE sales_time </span><span class="pun">&gt;=</span><span class="pln"> FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">7</span><span class="pln"> DAY</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">
                      MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">7</span><span class="pln"> DAY</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span><span class="pln">
   AND sales_time </span><span class="pun">&lt;</span><span class="pln"> FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">())</span><span class="pln"> </span><span class="pun">-</span><span class="pln">
                      MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">())</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span><span class="pln">  </span></pre>
<p>Finally, this WHERE clause needs to be applied to our day-by-day 
summary of sales, and our report of the most recently completed week is 
done</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">SELECT DATE</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> AS sales_date</span><span class="pun">,</span><span class="pln">
       SUM</span><span class="pun">(</span><span class="pln">gross</span><span class="pun">)</span><span class="pln"> AS total</span><span class="pun">,</span><span class="pln">
       COUNT</span><span class="pun">(*)</span><span class="pln"> AS transactions
  FROM sales
 WHERE sales_time </span><span class="pun">&gt;=</span><span class="pln"> FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">7</span><span class="pln"> DAY</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">
                     MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">7</span><span class="pln"> DAY</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span><span class="pln">
   AND sales_time </span><span class="pun">&lt;</span><span class="pln"> FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">())</span><span class="pln"> </span><span class="pun">-</span><span class="pln">
                     MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">())</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span><span class="pln">
 GROUP BY DATE</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln">
 ORDER BY DATE</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span></pre>
<h2>Using Stored Functions for Date Computations</h2>
<p>You’ve probably noticed that this SQL code is quite repetitive. This 
repetition can be a little difficult to read. MySQL offers stored 
functions, and some (but not all) hosting providers allow their users to
 define their own stored functions. Let’s create stored functions for 
these formulas that take arbitrary DATETIME values and derive the 
beginnings of various time periods from them. This is a form of 
mathematical truncation. Just as TRUNC(3.14) yields 3, 
TRUNC_SUNDAY(‘2014-01-02′) yields ‘2013-12-19′ and 
TRUNC_MONTH(‘2014-01-02′) yields ‘2014-01-01′.&nbsp;We can define these 
functions:</p>
<ul>
<li>TRUNC_HOUR(time) retrieves the most recent date and hour for any 
DATETIME expression. “2013-12-31 10:15″ becomes “2013-12-31 10:00″</li>
<li>ROUND_HOUR(time) retrieves the <em>nearest</em>&nbsp;hour for any 
DATETIME expression. This is useful when you have timestamps for 
physical measurements. For example, “2013-12-31 23:45″ becomes 
“2014-01-01 00:00″. “2013-12-15 10:29″ and “2013-12-15 9:45″ both become
 “2013-12-15 10:00″.</li>
<li>TRUNC_N_MINUTES(time,n) retrieves the most recent n-minute boundary.
 For example, if n is 15, then&nbsp;“2013-12-31 23:59:50″ becomes 
“2013-12-31 23:45:00″. Similarly,&nbsp;&nbsp;“2013-12-31 10:01″ becomes 
“2013-12-31 10:00″. To group your times by tenths of hours, use 6 for 
your value of n: 6 minutes are a tenth of an hour.</li>
<li>TRUNC_N_HOURS(time,n) retrieves the most recent n-hour boundary. For
 example, if n is 6, then&nbsp;“2013-12-31 23:59:50″ becomes “2013-12-31
 18:00:00″. Similarly,&nbsp;&nbsp;“2013-12-31 10:01″ becomes “2013-12-31
 06:00″. To group your times into four groups per day, use 6 for your 
value of n: 6 hours are a quarter of a (24-hour) day.</li>
<li>TRUNC_DAY(time) retrieves the date (at midnight). “2013-12-31 10:15″ becomes “2013-12-31″</li>
<li>TRUNC_SUNDAY(time) retrieves the preceding Sunday. “2013-12-31 10:15″ becomes “2013-12-29″</li>
<li>TRUNC_MONDAY(time) retrieves the preceding Monday. “2013-12-31 10:15″ becomes “2013-12-30″</li>
<li>TRUNC_MONTH(time) retrieves the first day of the month. “2013-12-31 10:15″ becomes “2013-12-01″</li>
<li>TRUNC_QUARTER(time) retrieves the first day of the quarter.”2013-12-31 10:15″ becomes “2013-10-01″</li>
<li>TRUNC_YEAR(time) retrieves the first day of the year.”2013-12-31 10:15″ becomes “2013-01-01″</li>
</ul>
<p>With these functions defined, our date-summary queries get much 
easier to read. For example, the daily summary of sales for last week 
looks like this:</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">SELECT TRUNC_DAY</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> AS sales_date</span><span class="pun">,</span><span class="pln">
       SUM</span><span class="pun">(</span><span class="pln">gross</span><span class="pun">)</span><span class="pln"> AS total</span><span class="pun">,</span><span class="pln">
       COUNT</span><span class="pun">(*)</span><span class="pln"> AS transactions
  FROM sales
 WHERE sales_time </span><span class="pun">&gt;=</span><span class="pln"> TRUNC_SUNDAY</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">7</span><span class="pln"> DAY</span><span class="pun">)</span><span class="pln">
   AND sales_time </span><span class="pun">&lt;</span><span class="pln">  TRUNC_SUNDAY</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">())</span><span class="pln">
 GROUP BY TRUNC_DAY</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln">
 ORDER BY TRUNC_DAY</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln">  </span></pre>
<p>In similar fashion, a monthly summary of last year’s sales would look like this;</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln"> SELECT TRUNC_MONTH</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> AS month_beginning</span><span class="pun">,</span><span class="pln">
        SUM</span><span class="pun">(</span><span class="pln">gross</span><span class="pun">)</span><span class="pln"> AS total</span><span class="pun">,</span><span class="pln">
        COUNT</span><span class="pun">(*)</span><span class="pln"> AS transactions
   FROM sales
  WHERE sales_time </span><span class="pun">&gt;=</span><span class="pln"> TRUNC_YEAR</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">1</span><span class="pln"> YEAR</span><span class="pun">)</span><span class="pln">
    AND sales_time </span><span class="pun">&lt;</span><span class="pln">  TRUNC_YEAR</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">())</span><span class="pln">
  GROUP BY TRUNC_MONTH</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln">
  ORDER BY TRUNC_MONTH</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span></pre>
<h2>Indexes and efficiency</h2>
<p>When time series data tables are very large, indexes on DATETIME 
columns can be very helpful to speed up queries. In our example sales 
table, this is the index to use:</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">ALTER TABLE sales ADD INDEX sales_time </span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> USING BTREE</span><span class="pun">;</span></pre>
<p>When a BTREE index like this is present, a WHERE clause like the one 
in the previous section uses it to do a very efficient range scan. 
Notice that it’s possible to write WHERE clauses in ways that make 
indexes useless, however. For example:</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln"> WHERE TRUNC_YEAR</span><span class="pun">(</span><span class="pln">sales_time</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln">  </span><span class="com">/* inefficient! */</span><span class="pln">
       TRUNC_YEAR</span><span class="pun">(</span><span class="pln">CURRENT_DATE</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> INTERVAL </span><span class="lit">1</span><span class="pln"> YEAR</span><span class="pun">)</span></pre>
<p>will correctly retrieve all sales from last year. However, because it
 applies a function to the value of the column it’s using to search, it 
cannot use the index. So it will go through the whole table row by row, 
compute TRUNC_YEAR(sales_time), and compare it.</p>
<h2>Stored Functions Definitions</h2>
<p>These are the MySQL definitions of the stored TRUNC functions.</p>
<pre style="" class="brush: sql; title: ; notranslate prettyprint prettyprinted" title=""><span class="pln">DELIMITER $$

DROP FUNCTION IF EXISTS TRUNC_HOUR$$
CREATE
  FUNCTION TRUNC_HOUR</span><span class="pun">(</span><span class="pln">datestamp DATETIME</span><span class="pun">)</span><span class="pln">
  RETURNS DATETIME DETERMINISTIC NO SQL
  COMMENT </span><span class="str">'returns current hour'</span><span class="pln">
  RETURN DATE_FORMAT</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">,</span><span class="pln"> </span><span class="str">'%Y-%m-%d %H:00'</span><span class="pun">)</span><span class="pln">$$

DROP FUNCTION IF EXISTS TRUNC_DAY$$
CREATE
  FUNCTION TRUNC_DAY</span><span class="pun">(</span><span class="pln">datestamp DATETIME</span><span class="pun">)</span><span class="pln">
  RETURNS DATE DETERMINISTIC NO SQL
  COMMENT </span><span class="str">'returns current date (preceding midnight)'</span><span class="pln">
  RETURN DATE</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)</span><span class="pln">$$

DROP FUNCTION IF EXISTS TRUNC_SUNDAY$$
CREATE
  FUNCTION TRUNC_SUNDAY</span><span class="pun">(</span><span class="pln">datestamp DATETIME</span><span class="pun">)</span><span class="pln">
  RETURNS DATE DETERMINISTIC NO SQL
  COMMENT </span><span class="str">'returns preceding Sunday'</span><span class="pln">
  RETURN FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span><span class="pln">$$

DROP FUNCTION IF EXISTS TRUNC_MONDAY$$
CREATE
  FUNCTION TRUNC_MONDAY</span><span class="pun">(</span><span class="pln">datestamp DATETIME</span><span class="pun">)</span><span class="pln">
  RETURNS DATE DETERMINISTIC NO SQL
  COMMENT </span><span class="str">'returns preceding Monday'</span><span class="pln">
  RETURN FROM_DAYS</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">MOD</span><span class="pun">(</span><span class="pln">TO_DAYS</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">))</span><span class="pln">$$

DROP FUNCTION IF EXISTS TRUNC_MONTH$$
CREATE
  FUNCTION TRUNC_MONTH</span><span class="pun">(</span><span class="pln">datestamp DATETIME</span><span class="pun">)</span><span class="pln">
  RETURNS DATE DETERMINISTIC NO SQL
  COMMENT </span><span class="str">'returns preceding first of the month'</span><span class="pln">
  RETURN DATE</span><span class="pun">(</span><span class="pln">DATE_FORMAT</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">,</span><span class="pln"> </span><span class="str">'%Y-%m-01'</span><span class="pun">))</span><span class="pln">$$

DROP FUNCTION IF EXISTS TRUNC_QUARTER$$
CREATE
  FUNCTION TRUNC_QUARTER</span><span class="pun">(</span><span class="pln">datestamp DATETIME</span><span class="pun">)</span><span class="pln">
  RETURNS DATE DETERMINISTIC NO SQL
  COMMENT </span><span class="str">'returns preceding first of the quarter'</span><span class="pln">
  RETURN DATE</span><span class="pun">(</span><span class="pln">CONCAT</span><span class="pun">(</span><span class="pln">YEAR</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">),</span><span class="str">'-'</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">3</span><span class="pun">*(</span><span class="pln">QUARTER</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">),</span><span class="str">'-01'</span><span class="pun">))</span><span class="pln">$$

DROP FUNCTION IF EXISTS TRUNC_YEAR$$
CREATE
  FUNCTION TRUNC_YEAR</span><span class="pun">(</span><span class="pln">datestamp DATETIME</span><span class="pun">)</span><span class="pln">
  RETURNS DATE DETERMINISTIC NO SQL
  COMMENT </span><span class="str">'returns preceding first of the year'</span><span class="pln">
  RETURN DATE</span><span class="pun">(</span><span class="pln">DATE_FORMAT</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">,</span><span class="pln"> </span><span class="str">'%Y-01-01'</span><span class="pun">))</span><span class="pln">$$

DROP FUNCTION IF EXISTS TRUNC_N_MINUTES$$
CREATE
  FUNCTION TRUNC_N_MINUTES</span><span class="pun">(</span><span class="pln">datestamp DATETIME</span><span class="pun">,</span><span class="pln"> n INT</span><span class="pun">)</span><span class="pln">
  RETURNS DATETIME DETERMINISTIC NO SQL
  COMMENT </span><span class="str">'truncate to N minute boundary. For example,
           TRUNCATE_N_MINUTES(sometime, 15) gives the nearest
           preceding quarter hour'</span><span class="pln">
  RETURN DATE_FORMAT</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">,</span><span class="str">'%Y-%m-%d %H:00'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln">
                INTERVAL </span><span class="pun">(</span><span class="pln">MINUTE</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">
                          MINUTE</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)</span><span class="pln"> MOD n</span><span class="pun">)</span><span class="pln"> MINUTE$$

DROP FUNCTION IF EXISTS TRUNC_N_HOURS$$
CREATE
  FUNCTION TRUNC_N_HOURS</span><span class="pun">(</span><span class="pln">datestamp DATETIME</span><span class="pun">,</span><span class="pln"> n INT</span><span class="pun">)</span><span class="pln">
  RETURNS DATETIME DETERMINISTIC NO SQL
  COMMENT </span><span class="str">'truncate to N hour boundary. For example,
           TRUNCATE_N_HOURS(sometime, 12) gives the nearest
           preceding half-day (noon, or midnight'</span><span class="pln">
  RETURN DATE</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln">
                INTERVAL </span><span class="pun">(</span><span class="pln">HOUR</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">
                          HOUR</span><span class="pun">(</span><span class="pln">datestamp</span><span class="pun">)</span><span class="pln"> MOD n</span><span class="pun">)</span><span class="pln"> HOUR$$

DROP FUNCTION IF EXISTS ROUND_HOUR$$
CREATE
  FUNCTION ROUND_HOUR</span><span class="pun">(</span><span class="pln">datestamp DATETIME</span><span class="pun">)</span><span class="pln">
  RETURNS DATETIME DETERMINISTIC NO SQL
  COMMENT </span><span class="str">'returns nearest hour'</span><span class="pln">
  RETURN DATE_FORMAT</span><span class="pun">(</span><span class="pln">datestamp </span><span class="pun">+</span><span class="pln"> INTERVAL </span><span class="lit">30</span><span class="pln"> MINUTE</span><span class="pun">,</span><span class="pln"> </span><span class="str">'%Y-%m-%d %H:00'</span><span class="pun">)</span><span class="pln">$$

DELIMITER </span><span class="pun">;</span></pre>
<p>You are free to use these for any purpose you wish.</p>
<p>Notice that you could create MSSQL, Oracle, or PostGreSQL 
implementations of these functions. If you did that you’d make your 
time-interval reporting SQL more portable between makes and models of 
RDBMS.</p>
	    </div><!-- .entry-content -->
	    	<footer class="clearfix">
	    	</footer><!-- .entry -->	</article><!-- #post-197 -->
					<div id="posts-pagination" class="clearfix">
						<h3 class="sr-only">Post navigation</h3>
						<div class="previous pull-left"><a href="http://www.plumislandmedia.net/mysql/using-mysqls-geospatial-extension-location-finder/" rel="prev">← Using MySQL’s geospatial extension for a location finder</a></div>
						<div class="next pull-right"><a href="http://www.plumislandmedia.net/uncategorized/new-email-blast-service/" rel="next">New emailer services →</a></div>
					</div><!-- #posts-pagination -->

					
<div id="comments" class="comments-area">
	
			<h2 id="comments-title">
			<i class="fa fa-comments"></i>&nbsp;
			6 comments for “<span>SQL Reporting by time intervals</span>”		</h2>

		<ol class="commentlist">
					<li class="comment even thread-even depth-1">
			<div id="comment-4125" class="comment-body">
				<div class="comment-avatar">
					<img alt="" src="SQL%20reporting%20by%20calendar%20intervals_files/c493abfbae3bac6da57e9be314f9f64c.png" class="avatar avatar-60 photo" height="60" width="60">				</div>
				<div class="comment-content">
					<div class="comment-author">
						Mark Frater 					</div>
					<div class="comment-meta">
						September 23, 2014 at 6:19 am					</div>
					<div class="comment-text">
												<p>There seems to be a lot of sites with bad/mediocre advice
 on mysql. This site is NOT one of them. Well done Ollie on your clear 
and concise (not to mention useful) post. Mark, New Zealand.</p>
					</div>
										<div class="reply">
						<a class="comment-reply-link" href="#comment-4125" onclick='return addComment.moveForm("comment-4125", "4125", "respond", "197")'>Reply</a>					</div>
									</div>
			</div>
			<ul class="children">
		<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2">
			<div id="comment-4136" class="comment-body">
				<div class="comment-avatar">
					<img alt="" src="SQL%20reporting%20by%20calendar%20intervals_files/1bf48ab39f56debcc0a700130e4a6c00.jpg" class="avatar avatar-60 photo" height="60" width="60">				</div>
				<div class="comment-content">
					<div class="comment-author">
						Ollie 					</div>
					<div class="comment-meta">
						September 23, 2014 at 1:57 pm					</div>
					<div class="comment-text">
												<p>Thanks for the kind words, Mark. By the way, I’m looking 
for somebody in the Southern Hemisphere to test the location-finder code
 on this site, and make sure it works correctly there. If you get an 
opportunity …  Thanks!</p>
					</div>
										<div class="reply">
						<a class="comment-reply-link" href="#comment-4136" onclick='return addComment.moveForm("comment-4136", "4136", "respond", "197")'>Reply</a>					</div>
									</div>
			</div>
			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1">
			<div id="comment-1180" class="comment-body">
				<div class="comment-avatar">
					<img alt="" src="SQL%20reporting%20by%20calendar%20intervals_files/d004cf1713c18478c36126844be15b18.png" class="avatar avatar-60 photo" height="60" width="60">				</div>
				<div class="comment-content">
					<div class="comment-author">
						<a href="http://www.assistrx.com/" rel="external nofollow" class="url">Doug</a> 					</div>
					<div class="comment-meta">
						March 25, 2014 at 6:26 pm					</div>
					<div class="comment-text">
												<p>Ollie,</p>
<p>What is the difference between sales_date and sales_time? You seem to use them interchangeably in the beginning of the post.</p>
<p>Thanks,</p>
<p>Doug</p>
					</div>
										<div class="reply">
						<a class="comment-reply-link" href="#comment-1180" onclick='return addComment.moveForm("comment-1180", "1180", "respond", "197")'>Reply</a>					</div>
									</div>
			</div>
			<ul class="children">
		<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2">
			<div id="comment-1187" class="comment-body">
				<div class="comment-avatar">
					<img alt="" src="SQL%20reporting%20by%20calendar%20intervals_files/1bf48ab39f56debcc0a700130e4a6c00.jpg" class="avatar avatar-60 photo" height="60" width="60">				</div>
				<div class="comment-content">
					<div class="comment-author">
						Ollie 					</div>
					<div class="comment-meta">
						March 26, 2014 at 3:55 pm					</div>
					<div class="comment-text">
												<p>Doug, you’re right. I’ve corrected the problems.</p>
					</div>
										<div class="reply">
						<a class="comment-reply-link" href="#comment-1187" onclick='return addComment.moveForm("comment-1187", "1187", "respond", "197")'>Reply</a>					</div>
									</div>
			</div>
			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1">
			<div id="comment-651" class="comment-body">
				<div class="comment-avatar">
					<img alt="" src="SQL%20reporting%20by%20calendar%20intervals_files/171a0b31052504c457e45ea6873e77e8.png" class="avatar avatar-60 photo" height="60" width="60">				</div>
				<div class="comment-content">
					<div class="comment-author">
						Dave Marvin 					</div>
					<div class="comment-meta">
						February 9, 2014 at 3:54 pm					</div>
					<div class="comment-text">
												<p>Thanks, Ollie.  I greatly appreciate your efforts to 
provide clear descriptions and excellent examples.  I needed to 
summarize a time series by week. and your concise explanation was all I 
needed.</p>
					</div>
										<div class="reply">
						<a class="comment-reply-link" href="#comment-651" onclick='return addComment.moveForm("comment-651", "651", "respond", "197")'>Reply</a>					</div>
									</div>
			</div>
			<ul class="children">
		<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2">
			<div id="comment-652" class="comment-body">
				<div class="comment-avatar">
					<img alt="" src="SQL%20reporting%20by%20calendar%20intervals_files/1bf48ab39f56debcc0a700130e4a6c00.jpg" class="avatar avatar-60 photo" height="60" width="60">				</div>
				<div class="comment-content">
					<div class="comment-author">
						Ollie 					</div>
					<div class="comment-meta">
						February 9, 2014 at 4:50 pm					</div>
					<div class="comment-text">
												<p>Dave, you’re welcome. Thanks for the kind words!</p>
					</div>
										<div class="reply">
						<a class="comment-reply-link" href="#comment-652" onclick='return addComment.moveForm("comment-652", "652", "respond", "197")'>Reply</a>					</div>
									</div>
			</div>
			</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ol><!-- .commentlist -->

		
		
	
									<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.plumislandmedia.net/mysql/sql-reporting-time-intervals/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://www.plumislandmedia.net/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate="">
																			<p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" size="30" aria-required="true" type="text"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" size="30" aria-required="true" type="email"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" size="30" type="url"></p>
												<div class="wmd-panel"><div id="wmd-button-barcomment"><ul class="wmd-button-row" id="wmd-button-rowcomment"><li title="Strong &lt;strong&gt; Ctrl+B" id="wmd-bold-buttoncomment" style="left: 0px;" class="wmd-button"><span style="background-position: 0px 0px;"></span></li><li title="Emphasis &lt;em&gt; Ctrl+I" id="wmd-italic-buttoncomment" style="left: 25px;" class="wmd-button"><span style="background-position: -20px 0px;"></span></li><li id="wmd-spacer1comment" class="wmd-spacer wmd-spacer1"></li><li title="Hyperlink &lt;a&gt; Ctrl+L" id="wmd-link-buttoncomment" style="left: 75px;" class="wmd-button"><span style="background-position: -40px 0px;"></span></li><li title="Blockquote &lt;blockquote&gt; Ctrl+Q" id="wmd-quote-buttoncomment" style="left: 100px;" class="wmd-button"><span style="background-position: -60px 0px;"></span></li><li title="Code Sample &lt;pre&gt;&lt;code&gt; Ctrl+K" id="wmd-code-buttoncomment" style="left: 125px;" class="wmd-button"><span style="background-position: -80px 0px;"></span></li><li title="Image &lt;img&gt; Ctrl+G" id="wmd-image-buttoncomment" style="left: 150px;" class="wmd-button"><span style="background-position: -100px 0px;"></span></li><li id="wmd-spacer2comment" class="wmd-spacer wmd-spacer2"></li><li title="Numbered List &lt;ol&gt; Ctrl+O" id="wmd-olist-buttoncomment" style="left: 200px;" class="wmd-button"><span style="background-position: -120px 0px;"></span></li><li title="Bulleted List &lt;ul&gt; Ctrl+U" id="wmd-ulist-buttoncomment" style="left: 225px;" class="wmd-button"><span style="background-position: -140px 0px;"></span></li><li title="Heading &lt;h1&gt;/&lt;h2&gt; Ctrl+H" id="wmd-heading-buttoncomment" style="left: 250px;" class="wmd-button"><span style="background-position: -160px 0px;"></span></li><li title="Horizontal Rule &lt;hr&gt; Ctrl+R" id="wmd-hr-buttoncomment" style="left: 275px;" class="wmd-button"><span style="background-position: -180px 0px;"></span></li><li id="wmd-spacer3comment" class="wmd-spacer wmd-spacer3"></li><li title="Undo - Ctrl+Z" id="wmd-undo-buttoncomment" style="left: 325px;" class="wmd-button"><span style="background-position: -200px -20px;"></span></li><li title="Redo - Ctrl+Y" id="wmd-redo-buttoncomment" style="left: 350px;" class="wmd-button"><span style="background-position: -220px -20px;"></span></li><li title="Markdown Editing Help" style="right: 0px;" id="wmd-help-buttoncomment" class="wmd-button wmd-help-button"><span style="background-position: -240px 0px;"></span></li></ul></div><div style="display: none;" id="wmd-button-bar-help"> <p>To create code blocks or other preformatted text, indent by four spaces:</p>
        <pre class="wmd-help"><span class="wmd-help-spaces">&nbsp;&nbsp;&nbsp;&nbsp;</span>This will be displayed in a monospaced font. The first four 
<span class="wmd-help-spaces">&nbsp;&nbsp;&nbsp;&nbsp;</span>spaces will be stripped off, but all other whitespace
<span class="wmd-help-spaces">&nbsp;&nbsp;&nbsp;&nbsp;</span>will be preserved.
<span class="wmd-help-spaces">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<span class="wmd-help-spaces">&nbsp;&nbsp;&nbsp;&nbsp;</span>Markdown is turned off in code blocks:
<span class="wmd-help-spaces">&nbsp;&nbsp;&nbsp;&nbsp;</span> [This is not a link](http://example.com)
</pre>
        <p>
            To create not a block, but an inline code span, use backticks:
        </p>
        <pre class="wmd-help">Here is some inline `code`.</pre> <p>For more help see <a href="http://daringfireball.net/projects/markdown/syntax" rel="no-follow"> http://daringfireball.net/projects/markdown/syntax</a></p></div><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p><div id="wmd-previewcomment" class="wmd-panel wmd-preview prettyprint"></div></div>												<p class="form-submit">
							<input name="submit" id="submit" value="Post Comment" type="submit">
							<input name="comment_post_ID" value="197" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
						</p>
						<p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="385311f9e1" type="hidden"></p><p style="display: none;"></p>					<input id="ak_js" name="ak_js" value="1417111345735" type="hidden"></form>
							</div><!-- #respond -->
			</div><!-- #comments .comments-area -->
							</div>
				<div id="secondary" class="col-md-3 end" role="complementary">
		<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://www.plumislandmedia.net">
	<label>
		<span class="sr-only">Search for:</span>
		<input class="search-field" placeholder="Search …" name="s" type="search">
	</label>
</form></aside><aside id="text-2" class="widget widget_text">			<div class="textwidget"><div><a class="image-anchor" rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="SQL%20reporting%20by%20calendar%20intervals_files/80x15.png"></a><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">PlumIslandMedia.net</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://plumislandmedia.net/about" property="cc:attributionName" rel="cc:attributionURL">Oliver Jones</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</div></div>
		</aside><aside id="text-4" class="widget widget_text">			<div class="textwidget"><script async="" src="SQL%20reporting%20by%20calendar%20intervals_files/adsbygoogle.js"></script>
<!-- Plim1 -->
<ins data-adsbygoogle-status="done" class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-6636501829887153" data-ad-slot="8607281029"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" frameborder="0" height="280" width="336"></iframe></ins></ins></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
		</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
					<li>
				<a href="http://www.plumislandmedia.net/signs/digital-signage-vendor-list/">Digital signage vendor list</a>
						</li>
					<li>
				<a href="http://www.plumislandmedia.net/sql-time-processing/using-sql-report-time-intervals-oracle/">Using SQL to report by time intervals in Oracle</a>
						</li>
					<li>
				<a href="http://www.plumislandmedia.net/uncategorized/texture-photos/">Texture photos</a>
						</li>
					<li>
				<a href="http://www.plumislandmedia.net/oracle/fast-nearest-location-finder-oracle/">Fast nearest-location finder for Oracle</a>
						</li>
					<li>
				<a href="http://www.plumislandmedia.net/mysql/haversine-mysql-nearest-loc/">Fast nearest-location finder for SQL (MySQL, PostgreSQL, SQL Server)</a>
						</li>
				</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-35"><a href="http://www.plumislandmedia.net/category/signs/">Digital Signs</a>
</li>
	<li class="cat-item cat-item-33"><a href="http://www.plumislandmedia.net/category/geography/">Geography</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://www.plumislandmedia.net/category/jetpack/">Jetpack</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://www.plumislandmedia.net/category/kids/">Kids</a>
</li>
	<li class="cat-item cat-item-28"><a href="http://www.plumislandmedia.net/category/mysql/" title="Articles about the MySQL relational data management system.">MySQL</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://www.plumislandmedia.net/category/nonprofit/">Nonprofit</a>
</li>
	<li class="cat-item cat-item-38"><a href="http://www.plumislandmedia.net/category/oracle/">Oracle</a>
</li>
	<li class="cat-item cat-item-36"><a href="http://www.plumislandmedia.net/category/reference/">Reference</a>
</li>
	<li class="cat-item cat-item-31"><a href="http://www.plumislandmedia.net/category/rhetoric/" title="Rhetoric is the art of persuading people with words">Rhetoric</a>
</li>
	<li class="cat-item cat-item-30"><a href="http://www.plumislandmedia.net/category/sql-time-processing/">SQL Time Processing</a>
</li>
	<li class="cat-item cat-item-11"><a href="http://www.plumislandmedia.net/category/topten/">topten</a>
</li>
	<li class="cat-item cat-item-34"><a href="http://www.plumislandmedia.net/category/type/">Type</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://www.plumislandmedia.net/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-2"><a href="http://www.plumislandmedia.net/category/wordpress/" title="Notes and thoughts about using WordPress to get the word out there.">WordPress</a>
</li>
		</ul>
</aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
	<li><a href="http://www.plumislandmedia.net/2014/11/">November 2014</a></li>
	<li><a href="http://www.plumislandmedia.net/2014/10/">October 2014</a></li>
	<li><a href="http://www.plumislandmedia.net/2014/08/">August 2014</a></li>
	<li><a href="http://www.plumislandmedia.net/2014/07/">July 2014</a></li>
	<li><a href="http://www.plumislandmedia.net/2014/06/">June 2014</a></li>
	<li><a href="http://www.plumislandmedia.net/2014/05/">May 2014</a></li>
	<li><a href="http://www.plumislandmedia.net/2014/04/">April 2014</a></li>
	<li><a href="http://www.plumislandmedia.net/2014/03/">March 2014</a></li>
	<li><a href="http://www.plumislandmedia.net/2014/02/">February 2014</a></li>
	<li><a href="http://www.plumislandmedia.net/2014/01/">January 2014</a></li>
	<li><a href="http://www.plumislandmedia.net/2013/09/">September 2013</a></li>
	<li><a href="http://www.plumislandmedia.net/2013/03/">March 2013</a></li>
	<li><a href="http://www.plumislandmedia.net/2013/02/">February 2013</a></li>
	<li><a href="http://www.plumislandmedia.net/2013/01/">January 2013</a></li>
	<li><a href="http://www.plumislandmedia.net/2012/07/">July 2012</a></li>
	<li><a href="http://www.plumislandmedia.net/2009/08/">August 2009</a></li>
		</ul>
</aside><aside id="meta-2" class="widget widget_meta"><h3 class="widget-title">Meta</h3>			<ul>
						<li><a rel="nofollow" href="http://www.plumislandmedia.net/wp-login.php">Log in</a></li>
			<li><a href="http://www.plumislandmedia.net/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://www.plumislandmedia.net/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
</aside><aside id="text-3" class="widget widget_text">			<div class="textwidget"><div><a class="image-anchor" href="http://www.greengeeks.com/"><img src="SQL%20reporting%20by%20calendar%20intervals_files/greengeeks_hosted_seal1.gif" border="0"></a></div></div>
		</aside>	</div><!-- #secondary.widget-area -->		</div>
	</div>

	</main><!-- main -->

	<footer id="footer" role="contentinfo">
		<div id="footer-content" class="container">
			<div class="row">
				<div class="copyright col-lg-12">
					<span class="pull-left">Copyright © 2014  <a href="http://www.plumislandmedia.net/">Plum Island Media</a>. All Rights Reserved.</span>
					<span class="credit-link pull-right"><i class="fa fa-leaf"></i>Designed by <a href="https://themes.bavotasan.com/">bavotasan.com</a>.</span>
				</div><!-- .col-lg-12 -->
			</div><!-- .row -->
		</div><!-- #footer-content.container -->
	</footer><!-- #footer -->
</div><!-- #page -->

<span id="bruteprotect_uptime_check_string" style="display:none;">7ads6x98y</span><script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://www.plumislandmedia.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://www.plumislandmedia.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<link rel="stylesheet" id="wp-markdown-editor-group-css" href="SQL%20reporting%20by%20calendar%20intervals_files/minify-b1-wp-markdown-editor-9573feeeeace366f036ddeca40575da.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var theme_js_vars = {"arc":"1000","fittext":""};
/* ]]> */
</script>
<script type="text/javascript" src="SQL%20reporting%20by%20calendar%20intervals_files/minify-b1-comment-reply-32bc201c0263f2164c507fdeed147350.js"></script>
<script type="text/javascript" src="SQL%20reporting%20by%20calendar%20intervals_files/minify-b1-wp-markdown-sanitizer-ffd22120720129719e5d2b7690139.js"></script>

</body></html>